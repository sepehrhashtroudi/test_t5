10/17/2022 01:54:15 - INFO - __main__ -   Namespace(task='summarize', sub_task='python', lang='python', eval_task='', model_type='codet5', add_lang_ids=False, data_num=-1, start_epoch=0, num_train_epochs=15, patience=2, cache_path='saved_models/summarize/python/codet5_base_all_lr5_bs48_src256_trg128_pat2_e15/cache_data', summary_dir='tensorboard', data_dir='..//data', res_dir='saved_models/summarize/python/codet5_base_all_lr5_bs48_src256_trg128_pat2_e15/prediction', res_fn='results/summarize_codet5_base.txt', add_task_prefix=False, save_last_checkpoints=True, always_save_model=True, do_eval_bleu=True, model_name_or_path='../pretrained_models/codet5-base/', output_dir='saved_models/summarize/python/codet5_base_all_lr5_bs48_src256_trg128_pat2_e15', load_model_path=None, train_filename=None, dev_filename=None, test_filename=None, config_name='', tokenizer_name='../pretrained_models/codet5-base/', max_source_length=256, max_target_length=128, do_train=True, do_eval=True, do_test=True, do_lower_case=False, no_cuda=False, train_batch_size=48, eval_batch_size=48, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, save_steps=-1, log_steps=-1, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=1000, local_rank=-1, seed=1234)
10/17/2022 01:54:16 - WARNING - configs -   Process rank: -1, device: cpu, n_gpu: 0, distributed training: False, cpu count: 40
10/17/2022 01:54:19 - INFO - models -   Finish loading model [223M] from ../pretrained_models/codet5-base/
10/17/2022 01:57:40 - INFO - utils -   Read 251820 examples, avg src len: 100, avg trg len: 11, max src len: 512, max trg len: 222
10/17/2022 01:57:40 - INFO - utils -   [TOKENIZE] avg src len: 142, avg trg len: 12, max src len: 2016, max trg len: 245
10/17/2022 01:57:40 - INFO - utils -   Create cache data into saved_models/summarize/python/codet5_base_all_lr5_bs48_src256_trg128_pat2_e15/cache_data/train_all.pt
  0%|          | 0/251820 [00:00<?, ?it/s]  1%|          | 1574/251820 [00:00<00:41, 6024.72it/s]  1%|▏         | 3148/251820 [00:00<00:35, 6952.64it/s]  2%|▏         | 4722/251820 [00:00<00:34, 7196.21it/s]  3%|▎         | 6296/251820 [00:00<00:33, 7337.83it/s]  3%|▎         | 7870/251820 [00:01<00:33, 7337.70it/s]  4%|▍         | 9444/251820 [00:01<00:33, 7304.18it/s]  4%|▍         | 11018/251820 [00:01<00:33, 7195.17it/s]  5%|▌         | 12592/251820 [00:01<00:34, 7018.66it/s]  6%|▌         | 14166/251820 [00:02<00:34, 6871.67it/s]  6%|▋         | 15740/251820 [00:02<00:43, 5487.63it/s]  7%|▋         | 17314/251820 [00:02<00:41, 5700.83it/s]  8%|▊         | 18888/251820 [00:02<00:39, 5833.64it/s]  8%|▊         | 20462/251820 [00:03<00:37, 6219.00it/s]  9%|▉         | 22036/251820 [00:03<00:36, 6286.19it/s]  9%|▉         | 23610/251820 [00:03<00:35, 6402.68it/s] 10%|█         | 25184/251820 [00:03<00:35, 6435.16it/s] 11%|█         | 26758/251820 [00:04<00:35, 6391.64it/s] 11%|█▏        | 28332/251820 [00:04<00:34, 6570.51it/s] 12%|█▏        | 29906/251820 [00:04<00:34, 6485.38it/s] 13%|█▎        | 31480/251820 [00:04<00:33, 6502.33it/s] 13%|█▎        | 33054/251820 [00:05<00:33, 6457.70it/s] 14%|█▍        | 34628/251820 [00:05<00:32, 6640.68it/s] 14%|█▍        | 36202/251820 [00:05<00:34, 6220.90it/s] 15%|█▌        | 37776/251820 [00:05<00:33, 6324.02it/s] 16%|█▌        | 39350/251820 [00:06<00:34, 6219.92it/s] 16%|█▋        | 40924/251820 [00:06<00:33, 6320.57it/s] 17%|█▋        | 42498/251820 [00:06<00:32, 6373.52it/s] 18%|█▊        | 44072/251820 [00:06<00:32, 6342.58it/s] 18%|█▊        | 45646/251820 [00:07<00:32, 6312.15it/s] 19%|█▉        | 47220/251820 [00:07<00:34, 5966.56it/s] 19%|█▉        | 48794/251820 [00:07<00:32, 6286.00it/s] 20%|██        | 50368/251820 [00:07<00:32, 6265.65it/s] 21%|██        | 51942/251820 [00:08<00:31, 6255.50it/s] 21%|██▏       | 53516/251820 [00:08<00:31, 6373.15it/s] 22%|██▏       | 55090/251820 [00:09<00:49, 3994.27it/s] 23%|██▎       | 56664/251820 [00:09<00:45, 4297.89it/s] 23%|██▎       | 58238/251820 [00:09<00:40, 4743.94it/s] 24%|██▍       | 59812/251820 [00:09<00:37, 5122.20it/s] 24%|██▍       | 61386/251820 [00:10<00:35, 5429.71it/s] 25%|██▌       | 62960/251820 [00:10<00:32, 5738.60it/s] 26%|██▌       | 64534/251820 [00:10<00:32, 5837.21it/s] 26%|██▋       | 66108/251820 [00:10<00:31, 5969.64it/s] 27%|██▋       | 67682/251820 [00:11<00:29, 6337.26it/s] 28%|██▊       | 69256/251820 [00:11<00:27, 6630.60it/s] 28%|██▊       | 70830/251820 [00:11<00:27, 6598.21it/s] 29%|██▉       | 72404/251820 [00:11<00:27, 6610.40it/s] 29%|██▉       | 73978/251820 [00:12<00:27, 6574.10it/s] 30%|███       | 75552/251820 [00:12<00:26, 6595.26it/s] 31%|███       | 77126/251820 [00:12<00:26, 6594.23it/s] 31%|███▏      | 78700/251820 [00:12<00:26, 6621.99it/s] 32%|███▏      | 80274/251820 [00:12<00:26, 6560.86it/s] 33%|███▎      | 81848/251820 [00:13<00:25, 6578.17it/s] 33%|███▎      | 83422/251820 [00:13<00:25, 6596.86it/s] 34%|███▍      | 84996/251820 [00:13<00:25, 6635.79it/s] 34%|███▍      | 86570/251820 [00:13<00:24, 6651.31it/s] 35%|███▌      | 88144/251820 [00:14<00:24, 6655.79it/s] 36%|███▌      | 89718/251820 [00:14<00:24, 6603.08it/s] 36%|███▋      | 91292/251820 [00:14<00:24, 6640.42it/s] 37%|███▋      | 92866/251820 [00:14<00:24, 6523.33it/s] 38%|███▊      | 94440/251820 [00:15<00:24, 6432.17it/s] 38%|███▊      | 96014/251820 [00:15<00:23, 6541.15it/s] 39%|███▉      | 97588/251820 [00:15<00:23, 6502.85it/s] 39%|███▉      | 99162/251820 [00:15<00:24, 6348.20it/s] 40%|████      | 100736/251820 [00:16<00:47, 3210.44it/s] 41%|████      | 102310/251820 [00:17<00:40, 3691.07it/s] 41%|████▏     | 103884/251820 [00:17<00:34, 4316.36it/s] 42%|████▏     | 105458/251820 [00:17<00:30, 4755.22it/s] 43%|████▎     | 107032/251820 [00:17<00:28, 5106.83it/s] 43%|████▎     | 108606/251820 [00:18<00:25, 5558.51it/s] 44%|████▍     | 110180/251820 [00:18<00:24, 5875.53it/s] 44%|████▍     | 111754/251820 [00:18<00:22, 6106.18it/s] 45%|████▌     | 113328/251820 [00:18<00:23, 6014.34it/s] 46%|████▌     | 114902/251820 [00:19<00:22, 6017.32it/s] 46%|████▋     | 116476/251820 [00:19<00:22, 5999.20it/s] 47%|████▋     | 118050/251820 [00:19<00:21, 6135.61it/s] 48%|████▊     | 119624/251820 [00:19<00:21, 6272.34it/s] 48%|████▊     | 121198/251820 [00:20<00:20, 6412.27it/s] 49%|████▉     | 122772/251820 [00:20<00:19, 6461.26it/s] 49%|████▉     | 124346/251820 [00:20<00:19, 6493.31it/s] 50%|█████     | 125920/251820 [00:20<00:19, 6352.66it/s] 51%|█████     | 127494/251820 [00:21<00:19, 6462.43it/s] 51%|█████▏    | 129068/251820 [00:21<00:18, 6733.35it/s] 52%|█████▏    | 130642/251820 [00:21<00:17, 6898.95it/s] 53%|█████▎    | 132216/251820 [00:21<00:17, 6680.44it/s] 53%|█████▎    | 133790/251820 [00:22<00:17, 6631.61it/s] 54%|█████▍    | 135364/251820 [00:22<00:17, 6485.21it/s] 54%|█████▍    | 136938/251820 [00:22<00:17, 6428.33it/s] 55%|█████▌    | 138512/251820 [00:22<00:17, 6384.18it/s] 56%|█████▌    | 140086/251820 [00:23<00:17, 6465.62it/s] 56%|█████▋    | 141660/251820 [00:23<00:16, 6532.68it/s] 57%|█████▋    | 143234/251820 [00:23<00:16, 6616.17it/s] 58%|█████▊    | 144808/251820 [00:23<00:16, 6427.46it/s] 58%|█████▊    | 146382/251820 [00:24<00:16, 6292.62it/s] 59%|█████▉    | 147956/251820 [00:24<00:16, 6242.60it/s] 59%|█████▉    | 149530/251820 [00:24<00:16, 6258.97it/s] 60%|██████    | 151104/251820 [00:24<00:15, 6353.42it/s] 61%|██████    | 152678/251820 [00:25<00:15, 6377.07it/s] 61%|██████▏   | 154252/251820 [00:25<00:15, 6189.17it/s] 62%|██████▏   | 155826/251820 [00:26<00:36, 2644.54it/s] 63%|██████▎   | 157400/251820 [00:26<00:30, 3108.52it/s] 63%|██████▎   | 158974/251820 [00:27<00:26, 3565.05it/s] 64%|██████▍   | 160548/251820 [00:27<00:22, 4085.23it/s] 64%|██████▍   | 162122/251820 [00:27<00:18, 4723.98it/s] 65%|██████▌   | 163696/251820 [00:27<00:16, 5300.48it/s] 66%|██████▌   | 165270/251820 [00:28<00:14, 5788.02it/s] 66%|██████▋   | 166844/251820 [00:28<00:13, 6124.51it/s] 67%|██████▋   | 168418/251820 [00:28<00:13, 6198.16it/s] 68%|██████▊   | 169992/251820 [00:28<00:12, 6335.63it/s] 68%|██████▊   | 171566/251820 [00:29<00:12, 6293.68it/s] 69%|██████▉   | 173140/251820 [00:29<00:12, 6188.05it/s] 69%|██████▉   | 174714/251820 [00:29<00:12, 6187.72it/s] 70%|███████   | 176288/251820 [00:29<00:12, 6169.07it/s] 71%|███████   | 177862/251820 [00:30<00:12, 6127.70it/s] 71%|███████▏  | 179436/251820 [00:30<00:12, 5930.24it/s] 72%|███████▏  | 181010/251820 [00:30<00:11, 5958.40it/s] 73%|███████▎  | 182584/251820 [00:30<00:11, 6092.70it/s] 73%|███████▎  | 184158/251820 [00:31<00:10, 6276.41it/s] 74%|███████▍  | 185732/251820 [00:31<00:10, 6373.09it/s] 74%|███████▍  | 187306/251820 [00:31<00:10, 6391.79it/s] 75%|███████▌  | 188880/251820 [00:31<00:09, 6640.22it/s] 76%|███████▌  | 190454/251820 [00:32<00:09, 6392.45it/s] 76%|███████▋  | 192028/251820 [00:32<00:09, 6296.70it/s] 77%|███████▋  | 193602/251820 [00:32<00:09, 6363.51it/s] 78%|███████▊  | 195176/251820 [00:32<00:08, 6661.58it/s] 78%|███████▊  | 196750/251820 [00:33<00:08, 6451.22it/s] 79%|███████▉  | 198324/251820 [00:33<00:08, 6407.01it/s] 79%|███████▉  | 199898/251820 [00:33<00:08, 6325.16it/s] 80%|████████  | 201472/251820 [00:33<00:08, 6246.75it/s] 81%|████████  | 203046/251820 [00:34<00:07, 6427.96it/s] 81%|████████▏ | 204620/251820 [00:34<00:07, 6552.05it/s] 82%|████████▏ | 206194/251820 [00:34<00:06, 6654.95it/s] 83%|████████▎ | 207768/251820 [00:34<00:06, 6654.74it/s] 83%|████████▎ | 209342/251820 [00:35<00:06, 6358.92it/s] 84%|████████▍ | 210916/251820 [00:35<00:06, 6247.42it/s] 84%|████████▍ | 212490/251820 [00:35<00:06, 6343.23it/s] 85%|████████▌ | 214064/251820 [00:35<00:06, 6196.97it/s] 86%|████████▌ | 215638/251820 [00:36<00:05, 6061.05it/s] 86%|████████▋ | 217212/251820 [00:36<00:05, 5977.22it/s] 87%|████████▋ | 218786/251820 [00:36<00:05, 5997.46it/s] 88%|████████▊ | 220360/251820 [00:36<00:05, 5850.09it/s] 88%|████████▊ | 221934/251820 [00:37<00:04, 6037.18it/s] 89%|████████▉ | 223508/251820 [00:37<00:04, 6181.62it/s] 89%|████████▉ | 225082/251820 [00:39<00:13, 2017.38it/s] 90%|█████████ | 226656/251820 [00:39<00:10, 2427.57it/s] 91%|█████████ | 228230/251820 [00:40<00:08, 2933.99it/s] 91%|█████████▏| 229804/251820 [00:40<00:06, 3421.13it/s] 92%|█████████▏| 231378/251820 [00:40<00:05, 3985.25it/s] 93%|█████████▎| 232952/251820 [00:40<00:04, 4565.08it/s] 93%|█████████▎| 234526/251820 [00:40<00:03, 5157.93it/s] 94%|█████████▍| 236100/251820 [00:41<00:02, 5521.21it/s] 94%|█████████▍| 237674/251820 [00:41<00:02, 5744.98it/s] 95%|█████████▌| 239248/251820 [00:41<00:02, 5943.79it/s] 96%|█████████▌| 240822/251820 [00:41<00:01, 6224.76it/s] 96%|█████████▋| 242396/251820 [00:42<00:01, 6312.28it/s] 97%|█████████▋| 243970/251820 [00:42<00:01, 6314.75it/s] 98%|█████████▊| 245544/251820 [00:42<00:01, 6168.71it/s] 98%|█████████▊| 247118/251820 [00:42<00:00, 6156.78it/s] 99%|█████████▉| 248692/251820 [00:43<00:00, 6237.97it/s] 99%|█████████▉| 250266/251820 [00:43<00:00, 6176.79it/s]100%|██████████| 251820/251820 [00:43<00:00, 5792.61it/s]
Traceback (most recent call last):
  File "/lustre03/project/6025819/sepehr8/test_generation/CodeT5/sh/..//run_gen.py", line 387, in <module>
    main()
  File "/lustre03/project/6025819/sepehr8/test_generation/CodeT5/sh/..//run_gen.py", line 190, in main
    train_examples, train_data = load_and_cache_gen_data(args, args.train_filename, pool, tokenizer, 'train')
  File "/lustre03/project/6025819/sepehr8/test_generation/CodeT5/utils.py", line 43, in load_and_cache_gen_data
    all_target_ids = torch.tensor([f.target_ids for f in features], dtype=torch.long)
RuntimeError: [enforce fail at alloc_cpu.cpp:66] . DefaultCPUAllocator: can't allocate memory: you tried to allocate 257863680 bytes. Error code 12 (Cannot allocate memory)
